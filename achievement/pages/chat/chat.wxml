<!-- æ“‚å°æ¨¡å¼ï¼šä¸¤äººå„å ä¸€ç«–é•¿å¡ç‰‡å±…ä¸­ï¼Œå…±åŒæˆå°±å€¼ä¸€ä¸ªï¼Œæ—  VS -->
<view class="arena-container">
  <!-- é¡µé¢ä¸­å¿ƒï¼šä¸¤ä¸ªç«–é•¿å¡ç‰‡ï¼Œç‚¹å‡»å„è‡ªå¤´åƒæŸ¥çœ‹å„è‡ªæˆå°± -->
  <view class="arena-cards-wrap">
    <view class="arena-card arena-card-partner" bindtap="gotoPartnerAchievement">
      <view class="arena-card-avatar-wrap">
        <block wx:if="{{partner.avatar === defaultAvatarUrl}}">
          <view class="arena-card-avatar arena-avatar-placeholder"><text class="arena-avatar-icon">ğŸ‘¤</text></view>
        </block>
        <image wx:else class="arena-card-avatar" src="{{partner.avatar}}" mode="aspectFill" />
      </view>
      <text class="arena-card-name">{{partner.nickName || 'ä¼™ä¼´'}}</text>
    </view>
    <view class="arena-card arena-card-me" bindtap="gotoMyAchievement">
      <view class="arena-card-avatar-wrap">
        <block wx:if="{{me.avatar === defaultAvatarUrl}}">
          <view class="arena-card-avatar arena-avatar-placeholder"><text class="arena-avatar-icon">ğŸ‘¤</text></view>
        </block>
        <image wx:else class="arena-card-avatar" src="{{me.avatar}}" mode="aspectFill" />
      </view>
      <text class="arena-card-name">{{me.nickName || 'æˆ‘'}}</text>
    </view>
  </view>
  <!-- å…±åŒæˆå°±å€¼ï¼ˆä»…ä¸€ä¸ªï¼Œæ—  VSï¼‰ï¼›å·¦æ»‘è¿›å…¥æˆå°±ç©ºé—´ï¼ˆæ­¤å¤„å§‹ç»ˆå¯æ»‘ï¼‰ -->
  <view
    class="arena-common-score-wrap"
    bindtouchstart="onPendingSwipeStart"
    bindtouchend="onPendingSwipeEnd"
  >
    <text class="arena-common-label">æˆ‘ä¸ä¼™ä¼´çš„å…±åŒæˆå°±å€¼</text>
    <text class="arena-common-value">{{commonAchieveScore}}</text>
    <text class="arena-swipe-hint">å·¦æ»‘è¿›å…¥å…±åŒæˆå°±ç©ºé—´ â€º</text>
  </view>

  <!-- å¯¹æ–¹å‘èµ·çš„ä»»åŠ¡ï¼ˆå¾…æˆ‘æ¥å—/æ‹’ç»ï¼‰ï¼›å·¦æ»‘è¿›å…¥æˆå°±ç©ºé—´ -->
  <view
    class="arena-pending-wrap"
    wx:if="{{pendingInvites.length > 0}}"
    bindtouchstart="onPendingSwipeStart"
    bindtouchend="onPendingSwipeEnd"
  >
    <view class="arena-pending-title-row">
      <text class="arena-pending-title">å¯¹æ–¹å‘èµ·çš„ä»»åŠ¡</text>
      <text class="arena-pending-swipe-hint">å·¦æ»‘è¿›å…¥å…±åŒæˆå°±ç©ºé—´ â€º</text>
    </view>
    <view class="arena-pending-item" wx:for="{{pendingInvites}}" wx:key="inviteId">
      <view class="arena-pending-desc">{{item.timeDisplay}} {{item.place}} {{item.sportType}}</view>
      <view class="arena-pending-actions">
        <button class="arena-pending-btn arena-pending-accept" data-invite-id="{{item.inviteId}}" bindtap="openAcceptReminderSheet">æ¥å—</button>
        <button class="arena-pending-btn arena-pending-reject" data-invite-id="{{item.inviteId}}" bindtap="openRejectSheet">æ‹’ç»</button>
      </view>
    </view>
  </view>

  <!-- æœ¬ç•Œé¢åªæ˜¾ç¤ºä¸€ä¸ªä»»åŠ¡æ ‡è¯†ï¼Œç‚¹å‡»è¿›å†å²ä»»åŠ¡ -->
  <view class="arena-task-indicator" wx:if="{{currentTask}}" bindtap="goTaskHistory">
    <text class="arena-task-label">å½“å‰ä»»åŠ¡</text>
    <text class="arena-task-desc">{{currentTask.time}} {{currentTask.place}} {{currentTask.sportType}}</text>
    <text class="arena-task-arrow">æŸ¥çœ‹å†å² â€º</text>
  </view>
  <view class="arena-task-indicator arena-task-empty" wx:else bindtap="goTaskHistory">
    <text class="arena-task-empty-text">æš‚æ— è¿›è¡Œä¸­ä»»åŠ¡ï¼Œç‚¹å‡»æŸ¥çœ‹å†å²</text>
  </view>

  <!-- åº•éƒ¨ï¼šå‘èµ·ä»»åŠ¡ -->
  <view class="arena-footer">
    <button class="arena-task-btn" bindtap="showTaskPanel">å‘èµ·ä»»åŠ¡</button>
  </view>
</view>

<!-- ä»»åŠ¡å‘èµ·å¼¹å±‚ï¼ˆæ—¶é—´ã€åœ°ç‚¹ã€è¿åŠ¨ç±»å‹ï¼‰ -->
<view class="task-mask" wx:if="{{taskPanelVisible}}" bindtap="hideTaskPanel"></view>
<view class="task-panel" wx:if="{{taskPanelVisible}}">
  <view class="task-panel-title">å‘èµ·çº¦è¿åŠ¨</view>
  <view class="task-panel-row">
    <text class="task-panel-label">æ—¥æœŸ</text>
    <picker mode="date" start="{{taskDateStart}}" end="{{taskDateEnd}}" value="{{taskDate}}" bindchange="onTaskDateChange">
      <view class="task-panel-value">{{taskDateDisplay || 'é€‰æ‹©æ—¥æœŸï¼ˆæœ€è¿‘2å‘¨ï¼‰'}}</view>
    </picker>
  </view>
  <view class="task-panel-row">
    <text class="task-panel-label">æ—¶é—´</text>
    <picker mode="time" value="{{taskTime}}" bindchange="onTaskTimeChange">
      <view class="task-panel-value">{{taskTime || 'é€‰æ‹©æ—¶é—´ï¼ˆ00:00-23:59ï¼‰'}}</view>
    </picker>
  </view>
  <view class="task-panel-row task-panel-row-place" bindtap="chooseTaskPlace">
    <text class="task-panel-label">åœ°ç‚¹</text>
    <view class="task-panel-value task-panel-place">
      <text class="task-panel-place-text" wx:if="{{taskPlace}}">{{taskPlace}}</text>
      <text class="task-panel-place-placeholder" wx:else>ç‚¹å‡»é€‰æ‹©åœ°ç‚¹ï¼ˆåœ°å›¾é€‰ç‚¹ï¼‰</text>
      <text class="task-panel-place-icon">ğŸ“</text>
    </view>
  </view>
  <view class="task-panel-row task-panel-row-place-manual" wx:if="{{taskPlace}}">
    <text class="task-panel-label"></text>
    <text class="task-panel-place-address">{{taskPlaceAddress || ''}}</text>
  </view>
  <view class="task-panel-row">
    <text class="task-panel-label">è¿åŠ¨ç±»å‹</text>
    <picker mode="selector" bindchange="onTaskSportChange" value="{{taskSportIndex}}" range="{{taskSportOptions}}">
      <view class="task-panel-value">{{taskSportText || 'é€‰æ‹©ç±»å‹'}}</view>
    </picker>
  </view>
  <button class="task-panel-btn" bindtap="submitTask">å‘èµ·</button>
</view>

<!-- æ‹’ç»ç†ç”±å¼¹å±‚ï¼šé€‰æ‹©ç†ç”±æˆ–è¾“å…¥è¯´æ˜ -->
<view class="reject-mask" wx:if="{{rejectSheetVisible}}" bindtap="hideRejectSheet"></view>
<view class="reject-sheet" wx:if="{{rejectSheetVisible}}">
  <view class="reject-sheet-title">æ‹’ç»ç†ç”±</view>
  <view class="reject-sheet-reasons">
    <view
      class="reject-reason-item {{rejectReasonIndex === index ? 'reject-reason-active' : ''}}"
      wx:for="{{rejectReasonOptions}}"
      wx:key="*this"
      data-index="{{index}}"
      bindtap="onRejectReasonTap"
    >{{item}}</view>
  </view>
  <view class="reject-sheet-input-wrap" wx:if="{{rejectReasonIndex === rejectReasonOtherIndex}}">
    <textarea class="reject-sheet-input" placeholder="è¯·è¾“å…¥æ‹’ç»è¯´æ˜ï¼ˆé€‰å¡«ï¼‰" value="{{rejectReasonText}}" bindinput="onRejectReasonInput" maxlength="100" />
  </view>
  <view class="reject-sheet-input-wrap" wx:else>
    <textarea class="reject-sheet-input" placeholder="å¯è¡¥å……è¯´æ˜ï¼ˆé€‰å¡«ï¼‰" value="{{rejectReasonText}}" bindinput="onRejectReasonInput" maxlength="100" />
  </view>
  <button class="reject-sheet-btn" bindtap="confirmReject">ç¡®è®¤æ‹’ç»</button>
</view>

<!-- æ¥å—åè®¾ç½®æé†’ï¼šé€‰æ‹©æå‰å¤šä¹…æé†’ï¼Œä¸å¾®ä¿¡è®¢é˜…æ¶ˆæ¯äº’é€š -->
<view class="reminder-mask" wx:if="{{acceptReminderVisible}}" bindtap="hideAcceptReminderSheet"></view>
<view class="reminder-sheet" wx:if="{{acceptReminderVisible}}">
  <view class="reminder-sheet-title">è®¾ç½®æé†’</view>
  <view class="reminder-sheet-desc">åœ¨è®¾å®šæ—¶é—´é€šè¿‡å¾®ä¿¡æœåŠ¡é€šçŸ¥æé†’ä½ </view>
  <view class="reminder-sheet-options">
    <view
      class="reminder-option {{reminderIndex === index ? 'reminder-option-active' : ''}}"
      wx:for="{{reminderOptions}}"
      wx:key="minutes"
      data-index="{{index}}"
      bindtap="onReminderOptionTap"
    >{{item.text}}</view>
  </view>
  <button class="reminder-sheet-btn" bindtap="confirmAcceptWithReminder">ç¡®å®š</button>
</view>
